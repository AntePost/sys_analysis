# Выбор архитектурного стиля
- Выбран распределенный стиль. Обоснование:
  - Нефункциональные характеристики, общие для всего проекта (высокие agility, testability и deployability, так как нужен высокий TTM)
  - Разные нефункциональные характеристики отдельных частей проекта
- Выбран микросервисный подход. Обоснование:
  - С учетом требований финансового отдела о надежности и высокой нагрузки на одни части системы, но не на другие, - service-based, где единая БД является single point of failure, нам не подходит. Следовательно выбираем микросервисы
# Разбивка на сервисы
- Поддомен **Managing order life-cycle**
  - У BC (bounded context) **Order life-cycle management system** есть отдельные характеристики, которых нет у других BC, поэтому его делаем отдельным сервисом
  - У двух биллингов (клиентов и воркеров) отличаются характеристики (различные циклы биллинга и у клиентов нужна высокая interoperability), поэтому их делаем двумя разными сервисами
  - У BC **Order quality control** нет каких-то особых характеристик и предметная область не связана с биллингом, поэтому его также делаем отдельным сервисом
- Поддомен **Speeding up order fulfillment**
  - BC **Order packaging warehouse** обладает теми же характеристиками, что и BC **Order life-cycle management system** и связан функционально только с ним.
  - Поэтому логично объединить его с сервисом **Order life-cycle management system** выше
  - Тем более, что software-функционал там простой - всего лишь дать сотрудникам склада возможность отмечать заказы как собранные
- Поддомен **Getting the best worker for client's order**
  - BC **Matching algorithm** обладает уникальными характеристиками, поэтому его делаем отдельным сервисом
- Поддомен **Finding the best workers among applicants**
  - BC **System of applicant testing** также обладает уникальными характеристиками.
  - Также для этого BC сложно соблюсти все характеристики в одном сервисе (высокая elastisity vs modifiablitity, agility etc), поэтому часть относящаяся к эластичности (защита от DDoS атак) была вынесена в отдельную внешнюю систему.
# Стили отдельных сервисов
- Для большинства сервисов подойдет layered monolith как дефолтный стиль
- Для сервиса матчинга был выбрал pipeline стиль, исходя из требований (алгоритм был описан как map-reduce)
- Для сервиса тестирования applicants был выбран microkernel для обеспечения высокой modifiability в связи с регулярным тестированием гипотез
- Для центрального сервиса по менеджменту жизненного цикла заказа был выбран модульный монолит из-за более высокого значения maintainabilty и разделению по доменам (сервис также содержит логику склада)
# Выбор баз данных
С учетом выбранных характеристик, для всех сервисов подходят реляционные БД с оговоркой, что БД для сервисов биллинга должна отличаться повышенной security и consistency
# Выбор стиля коммуницаций
- Большая часть коммуникаций в проекте связана с BC **Order life-cycle management system**
- Из них синхронными стоит сделать только те, которые связаны с основным флоу заказа, чтобы обеспечить минимальную задержку и гарантировать доставку. Это коммуникации с **Matching algorithm**, **Order packaging warehouse** и **Fur-tune cookie provider**.
- Остальные коммуникации (стриминг информации о заказах в биллинги, систему ставок и отдел контроля качества) можно сделать асинхронными
- В дополнение к этому в проекте есть стриминг данных о клиентах (из внешней системы) и о воркерах. Эти коммуникации также можно сделать асинхронными, так как для них задержка некритична
# Выбор фитнес функций для проекта
- Общие для системы
  - Test coverage (% to be determined in the future)
  - Проверка периодичности релизов (мануально либо с помощью скрипта, анализирующего данные CI-системы), не реже, чем 1 раз в месяц
  - Ревью schema registry и "очередей" ("топиков") в message broker с целью сохранить существующее разделение на сервис и виды коммуникаций
- **3rd-party DDoS protection** + **System of applicant testing** - автоматическое стресс-тестирование для имитации DDoS-атаки
- Качественная оценка *легкости и скорости модификации* сервисов матчинга и тестирования applicants на основе метрик системы трекинга задач и опросов разработчиков и менеджеров
- Оценка периодичности релизов сервиса тестирования applicants (не реже, чем 1 раз в неделю) аналогичным способом, указанным выше
- Оценка interoperability сервиса тестирования applicants (для дальнейшего выделения в отдельный продукт) путем качественного анализа четкости границы между этим функционалом и остальными частями системы.
  - Цель, обеспечить низкий каплинг и смотреть за тем, чтобы он не рос по мере развития системы
- Оценка interoperability системы биллинга клиентов путем оценки трудоемкости интеграции нового платежного шлюза (не должна превышать определенного значения) на основе опросов разработчиков и менеджеров
- Оценка scalability для части системы, связанной с флоу заказав путем стресс-тестов, имитирующих высокую нагрузку на систему
- Оценка security биллинг сервисов путем удостоверения, что используются лучшие практики, аудита со стороны специалистов по IB, проведения penetration testing
